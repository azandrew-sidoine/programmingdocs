# Packaging application for Destop

## JPackage (jdk 14+)

Because jpackage is part of the JDK distribution, it is as easy to invoke as the regular java or javac command. The jpackage executable is located in the same directory as the java and javac executables.

**Note**
When invoked, jpackage will create a native application, based on provided code, dependencies, and resources. It will bundle a Java runtime with the native application, and when the application is executed, the packaged Java runtime will execute the Java code, similar to the case where the runtime was installed separately on the system.

### JPackage packaging options

* Non-modular applications that run on the classpath, from one or more jar files
* Modular applications with one or more modular jar files or jmod files
* Modular applications that have been jlinked into a custom runtime image

The output of jpackage is a self-contained application image. The image can include the following:

* Native application launcher (generated by the tool)
* Application resources (like jar, icns, ico, png)
* Configuration files (like plist, cfg, properties)
* Helper libraries for the launcher
* The Java runtime image, for example, the files that are needed to execute Java bytecode

**Warning**
Since jpackage is capable of building an executable for the current platform, you have to run jpackage on all platforms you want to support. Cross-compiling a Java application from one platform into native executables for other platforms is not supported.

> jpackage <opions> -> Page 418 for options

Example:

Compile your application:

> javac --module-path $PATH_TO_FX --add-modules javafx.

         controls,javafx.fxml -d out $(find src -name "*.java")
         cp src/org/modernclients/scene.fxml src/org/modernclients/styles.
         css out/org/modernclients/

Run and test:

> java --module-path $PATH_TO_FX --add-modules javafx.

         controls,javafx.fxml -cp out org.modernclients.Main

Create .jar:

> mkdir libs
> jar --create --file=libs/sample1.jar --main-class=org.

         modernclients.Main -C out .

> $JAVA_HOME/bin/jpackage --installer-type dmg -o installer -i libs --main-

jar sample1.jar -n Sample1 --module-path $PATH_TO_FX_MODS --add-modules
javafx.controls, javafx.fxml --main-class org.modernclients. Main --win-menu
--win-shortcut --win-dir-chooser --icon assets\win\openduke.icns

#### Gradle Projects

```groovy
plugins {
    id 'application'
    id 'org.openjfx.javafxplugin' version '0.0.8'
    id 'org.beryx.jlink' version '2.15.1'
}
repositories {
    mavenCentral()
}
javafx {
    modules = [ 'javafx.controls', 'javafx.fxml' ]
}

mainClassName = "$moduleName/org.modernclients.Main" // Path to the main class
jlink {
    options = ['--strip-debug', '--compress', '2', '--no-header-files', '--no-man-pages']
    launcher {
        name = 'sample3'
    }
    jpackage {
        if (javafx.getPlatform().name() == "OSX") {
            installerType = "dmg"
            jpackageHome = "Path/To/Jdk/Home"
        } else if (javafx.getPlatform().name() == "WINDOWS") {
            installerType = "exe"
            jpackageHome = "Path\\To\JDK\Home"
            installerOptions = ['--win-menu', '--win-shortcut',
            '--win-dir-chooser']
        } else if (javafx.getPlatform().name() == "LINUX") {
            installerType = "deb"
            jpackageHome = "Path/To/Jdk/Home"
        }
    } 
}

```

Run & Test (Window | Mac OS):

> ./gradlew run

Run & Test (Window)

> gradlew run

Create custom image (Window | Mac OS):

> ./gradlew jlink

Create custom image (Window)

> gradlew jlink

Create custom image (Window | Mac OS):

> ./build/image/bin/app

Create custom image (Window)

> build\image\bin\app

Create the installer: (Mac or Linux)

> ./gradlew jpackage

Create the installer: (Windows)

> gradlew jpackage

## Using Graal’s Native (AOT native compiler)

Another option for building a native application moves that compilation step to build time. With `GraalVM’s Native Image` , the Java code is compiled `Ahead Of Time (AOT)` , which means that the java bytecode is compiled to native code before it is executed and before it is bundled in an application.

Packaged application does not contains the java runtime (JIT) compiler, but native code.

**Warning**
Although the GraalVM project has been active for many years, it only recently became available as a product. It is still in evolution, and parts of it are integrated with the OpenJDK project and vice versa. We recommend to regularly keep an eye on the [https://graalvm.org] web site and on the GitHub site for the open source code at [https://github.com/oracle/graal].

Requirement:

* OpenJDK 11.0.2
* AdoptOpenJDK
* JAVA_HOME
